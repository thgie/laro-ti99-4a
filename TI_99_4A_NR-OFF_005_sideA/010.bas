   60 REM  ZEICHEN-DEFINITION 
   70 REM  PROG-AID-1/JUNE 1982/GER/VERSION 1 
   80 REM   COPYRIGHT 1982 BY TEXAS INSTRUMENTS DEUTSCHLAND GMBH 
  100 DIM B ( 8 , 8 , 4 ) , M1$ ( 4 ) 
  105 CALL SCREEN ( 04 ) 
  110 CALL CHAR ( 104 , "FFFFFFFFFFFFFFFF" ) 
  120 CALL CHAR ( 112 , "FFFFFFFFFFFFFFFF" ) 
  130 CALL CHAR ( 120 , "FFFFFFFFFFFFFFFF" ) 
  140 CALL CHAR ( 128 , "FFFFFFFFFFFFFFFF" ) 
  150 CALL CHAR ( 100 , "0000000000000000" ) 
  160 CALL CHAR ( 101 , "FFFFFFFFFFFFFFFF" ) 
  170 GOSUB 3270
  175 CALL SCREEN ( 15 ) 
  180 FOR I = 9 TO 13 
  190 CALL COLOR ( I , FOREGROUND , BACKGROUND ) 
  200 NEXT I 
  210 KEEP = 0 
  220 MOVE = 1 
  230 HY = 4 
  240 HX = 2 
  250 RX1 = 1 
  260 RX2 = 8 
  270 CX1 = 1 
  280 CX2 = 8 
  290 RX = RX1 
  300 CX = CX1 
  310 REM -SET UP DISPLAY LABELS-   
  320 CALL CLEAR 
  330 PRINT "TI-99/4A  ZEICHEN-DEFINITION" 
  340 PRINT "AUTOMATIK:EIN   MODUS:NORMAL" 
  350 PRINT 
  360 PRINT "12345678  1=FFFFFFFFFFFFFFFF" 
  370 PRINT "        1 2=FFFFFFFFFFFFFFFF" 
  380 PRINT "        2 3=FFFFFFFFFFFFFFFF" 
  390 PRINT "        3 4=FFFFFFFFFFFFFFFF" 
  400 PRINT "        4" 
  410 PRINT "        5" 
  420 PRINT "        6" 
  430 PRINT "        7" 
  440 PRINT "        8                 12" 
  450 PRINT "12345678                  34" 
  460 PRINT " MUSTER    1   2   3   4" 
  470 PRINT 
  480 PRINT "0=PUNKT AUS    1=PUNKT EIN" 
  490 PRINT "M=MODUS:NORMAL T=MODUS:TP" 
  500 PRINT "C=CURSOR START I=INVERTIEREN" 
  510 PRINT "N=MUSTER NEU   P=TP DRUCKEN" 
  520 PRINT "S=LINKS E=AUF  D=RECHTS X=AB" 
  530 PRINT "R=AUFRUFEN     U=UEBERTRAGEN" 
  540 PRINT "A=AUTOMATIK:EIN/AUS" 
  550 PRINT 
  560 PRINT "INITIALISIERUNG-BITTE WARTEN"  ; 
  570 M$ = "12345678" 
  580 X = HX 
  590 Y = HY + 1 
  600 GOSUB 1580
  610 FOR I = 0 TO 3 
  620 CALL HCHAR ( 9 , 14 + 4 * I , 104 + 8 * I ) 
  630 FOR J = 0 TO 2 
  640 CALL HCHAR ( 11 + J , 13 + 4 * I , 104 + 8 * I , 3 ) 
  650 NEXT J 
  660 NEXT I 
  670 CALL HCHAR ( 9 , 29 , 104 ) 
  680 CALL HCHAR ( 9 , 30 , 112 ) 
  690 CALL HCHAR ( 10 , 29 , 120 ) 
  700 CALL HCHAR ( 10 , 30 , 128 ) 
  710 K1 = 0 
  720 K2 = 0 
  730 K3 = 0 
  740 GOSUB 830
  750 K1 = 1 
  760 K2 = 4 
  770 K3 = 1 
  780 GOSUB 830
  790 CALL HCHAR ( 24 , 1 , 32 , 30 ) 
  800 GOSUB 3200
  810 GOTO 940
  820 REM  -INITIALIZE 8X8 GRID- 
  830 FOR R = 1 TO 8 
  840 FOR C = 1 TO 8 
  850 FOR K = K1 TO K2 
  860 B ( R , C , K ) = K3 
  870 NEXT K 
  880 NEXT C 
  890 NEXT R 
  900 RETURN 
  910 REM -INPUT DOT PATTERN- 
  920 REM  
  930 REM  START LOOP HERE 
  940 CALL HCHAR ( RX + HY , CX + HX , 30 ) 
  942 FOR I = 1 TO 15 
  943 NEXT I 
  950 CALL HCHAR ( RX + HY , CX + HX , B ( RX , CX , 0 ) + 100 ) 
  953 FOR I = 1 TO 10 
  955 NEXT I 
  960 CALL KEY ( 0 , KEY , STATUS ) 
  970 IF STATUS = 0 THEN 940
  980 IF ( KEY = ASC ( "1" ) ) + ( KEY = ASC ( "0" ) ) = - 1 THEN 1140
  990 IF KEY = ASC ( "S" ) THEN 1640
 1000 IF KEY = ASC ( "D" ) THEN 1750
 1010 IF KEY = ASC ( "E" ) THEN 2040
 1020 IF KEY = ASC ( "X" ) THEN 1970
 1030 IF KEY = ASC ( "I" ) THEN 1860
 1040 IF KEY = ASC ( "U" ) THEN 2740
 1050 IF KEY = ASC ( "R" ) THEN 2990
 1060 IF KEY = ASC ( "C" ) THEN 2700
 1070 IF KEY = ASC ( "N" ) THEN 2910
 1080 IF KEY = ASC ( "P" ) THEN 1400
 1090 IF KEY = ASC ( "T" ) THEN 2290
 1100 IF KEY = ASC ( "M" ) THEN 2130
 1110 IF KEY = ASC ( "A" ) THEN 2590
 1120 GOTO 940
 1130 REM  -IF 0 OR 1 DO IT- 
 1140 KEY = KEY - 48 
 1150 B ( RX , CX , 0 ) = KEY 
 1160 CALL HCHAR ( RX + HY , CX + HX , 100 + KEY ) 
 1170 IF MOVE = 0 THEN 940
 1180 GOTO 1750
 1190 REM -BUILD HEX PATTERN STRING- 
 1200 HEX$ = "0123456789ABCDEF" 
 1210 M1$ ( KEEP ) = "" 
 1220 FOR R = 1 TO 8 
 1230 LOW = B ( R , 5 , 0 ) * 8 + B ( R , 6 , 0 ) * 4 + B ( R , 7 , 0 ) * 2 + B ( R , 8 , 0 ) + 1 
 1240 HIGH = B ( R , 1 , 0 ) * 8 + B ( R , 2 , 0 ) * 4 + B ( R , 3 , 0 ) * 2 + B ( R , 4 , 0 ) + 1 
 1250 M1$ ( KEEP ) = M1$ ( KEEP ) & SEG$ ( HEX$ , HIGH , 1 ) & SEG$ ( HEX$ , LOW , 1 ) 
 1260 NEXT R 
 1270 M$ = M1$ ( KEEP ) 
 1280 Y = 3 + KEEP 
 1290 X = 15 
 1300 GOSUB 1510
 1310 CALL CHAR ( 104 + 8 * ( KEEP - 1 ) , M1$ ( KEEP ) ) 
 1320 FOR I = 1 TO 8 
 1330 FOR J = 1 TO 8 
 1340 B ( I , J , KEEP ) = B ( I , J , 0 ) 
 1350 NEXT J 
 1360 NEXT I 
 1370 KEEP = 0 
 1380 RETURN 
 1390 REM -PRINT ROUTINE- 
 1400 OPEN # 1  : "TP.U.S" , OUTPUT 
 1410 FOR R1 = 4 TO 14 
 1420 A$ = "" 
 1430 FOR C1 = 2 TO 30 
 1440 CALL GCHAR ( R1 , C1 , X ) 
 1450 A$ = A$ & CHR$ ( X ) 
 1460 NEXT C1 
 1470 PRINT # 1  : A$ 
 1480 NEXT R1 
 1490 CLOSE # 1 
 1500 GOTO 940
 1510 REM -DISPLAY STRING HORIZONTALLY- 
 1520 FOR I1 = 1 TO LEN ( M$ ) 
 1530 CODE = ASC ( SEG$ ( M$ , I1 , 1 ) ) 
 1540 CALL HCHAR ( Y , X + I1 - 1 , CODE ) 
 1550 NEXT I1 
 1560 RETURN 
 1570 REM -DISPLAY STRING VERTICALLY- 
 1580 FOR I1 = 1 TO LEN ( M$ ) 
 1590 CODE = ASC ( SEG$ ( M$ , I1 , 1 ) ) 
 1600 CALL HCHAR ( Y + I1 - 1 , X , CODE ) 
 1610 NEXT I1 
 1620 RETURN 
 1630 REM   -LEFT ARROW WITH WRAPAROUND-   
 1640 CX = CX - 1 
 1650 IF CX < > RX1 - 1 THEN 940
 1660 IF MOVE = 1 THEN 1690
 1670 CX = CX + 1 
 1680 GOTO 940
 1690 CX = CX2 
 1700 RX = RX - 1 
 1710 IF RX < > RX1 - 1 THEN 940
 1720 RX = RX2 
 1730 GOTO 940
 1740 REM   -RIGHT ARROW WITH WRAPAROUND- 
 1750 CX = CX + 1 
 1760 IF CX < > CX2 + 1 THEN 940
 1770 IF MOVE = 1 THEN 1800
 1780 CX = CX - 1 
 1790 GOTO 940
 1800 CX = CX1 
 1810 RX = RX + 1 
 1820 IF RX < > RX2 + 1 THEN 940
 1830 RX = RX1 
 1840 GOTO 940
 1850 REM  -INVERSE VEDEO- 
 1860 FOR RV = RX1 TO RX2 
 1870 FOR CV = CX1 TO CX2 
 1880 IF B ( RV , CV , 0 ) = 1 THEN 1910
 1890 B ( RV , CV , 0 ) = 1 
 1900 GOTO 1920
 1910 B ( RV , CV , 0 ) = 0 
 1920 NEXT CV 
 1930 NEXT RV 
 1940 GOSUB 3200
 1950 GOTO 940
 1960 REM   -DOWN ARROWS-  
 1970 IF RX + 1 > RX2 THEN 2000
 1980 RX = RX + 1 
 1990 GOTO 940
 2000 IF MOVE = 0 THEN 940
 2010 RX = RX1 
 2020 GOTO 940
 2030 REM   -UP ARROW- 
 2040 IF RX - 1 > = RX1 THEN 2070
 2050 IF MOVE = 0 THEN 940
 2060 GOTO 2090
 2070 RX = RX - 1 
 2080 GOTO 940
 2090 IF MOVE = 0 THEN 940
 2100 RX = RX2 
 2110 GOTO 940
 2120 REM  -SET NORMAL MODE- 
 2130 RX1 = 1 
 2140 RX2 = 8 
 2150 CX1 = 1 
 2160 CX2 = 8 
 2170 CALL HCHAR ( HY + 1 , HX + 1 , 32 , 08 ) 
 2180 M$ = "       " 
 2190 X = HX + 1 
 2200 Y = HY + 2 
 2220 X = X + 6 
 2240 X = X + 1 
 2252 CALL HCHAR ( 5 , 3 , 100 , 8 ) 
 2253 CALL VCHAR ( 6 , 3 , 100 , 7 ) 
 2254 CALL VCHAR ( 6 , 9 , 100 , 7 ) 
 2255 CALL VCHAR ( 6 , 10 , 100 , 7 ) 
 2260 X$ = "NORMAL" 
 2270 GOTO 2430
 2280 REM  -SET PRINTER MODE- 
 2290 RX1 = 2 
 2300 RX2 = 8 
 2310 CX1 = 2 
 2320 CX2 = 6 
 2330 X$ = "TP    " 
 2340 CALL HCHAR ( HY + 1 , HX + 1 , 42 , 8 ) 
 2350 M$ = "*******" 
 2360 X = HX + 1 
 2370 Y = HY + 2 
 2380 GOSUB 1580
 2390 X = X + 6 
 2400 GOSUB 1580
 2410 X = X + 1 
 2420 GOSUB 1580
 2430 Y = 2 
 2440 X = 19 
 2450 M$ = "MODUS=" & X$ 
 2460 GOSUB 1510
 2470 RX = RX1 
 2480 CX = CX1 
 2490 FOR I = 1 TO 8 
 2500 B ( I , 1 , 0 ) = 0 
 2510 B ( I , 7 , 0 ) = 0 
 2520 B ( I , 8 , 0 ) = 0 
 2530 NEXT I 
 2540 FOR I = 2 TO 6 
 2550 B ( 1 , I , 0 ) = 0 
 2560 NEXT I 
 2570 GOTO 940
 2580 REM   -MOVE ON/OFF- 
 2590 MOVE = ABS ( MOVE - 1 ) 
 2600 M$ = "AUTOMATIK:" 
 2610 IF MOVE = 0 THEN 2640
 2620 M$ = M$ & "EIN " 
 2630 GOTO 2650
 2640 M$ = M$ & "AUS " 
 2650 Y = 2 
 2660 X = 3 
 2670 GOSUB 1510
 2680 GOTO 940
 2690 REM  -HOME- 
 2700 RX = RX1 
 2710 CX = CX1 
 2720 GOTO 940
 2730 REM   -KEEP IT-  
 2740 M$ = "AUF WELCHES ZEICHEN (1-4)?" 
 2750 Y = 24 
 2760 X = 3 
 2770 GOSUB 2800
 2780 GOSUB 1200
 2790 GOTO 940
 2800 REM  -BOTTOM LINE PROMPT-    
 2810 GOSUB 1520
 2820 CALL HCHAR ( 24 , 29 , 30 ) 
 2825 FOR I = 1 TO 15 
 2828 NEXT I 
 2830 CALL HCHAR ( 24 , 29 , 32 ) 
 2835 FOR I = 1 TO 15 
 2838 NEXT I 
 2840 CALL KEY ( 0 , KEY , STATUS ) 
 2850 IF STATUS = 0 THEN 2820
 2860 IF KEY < 49 THEN 2820
 2870 IF KEY > 52 THEN 2820
 2880 CALL HCHAR ( 24 , 1 , 32 , 30 ) 
 2890 KEEP = KEY - 48 
 2900 RETURN 
 2910 REM  -CLEAR- 
 2920 FOR R = RX1 TO RX2 
 2930 FOR C = CX1 TO CX2 
 2940 B ( R , C , 0 ) = 0 
 2950 NEXT C 
 2960 NEXT R 
 2970 GOSUB 3210
 2980 GOTO 940
 2990 REM  -RECALL IT- 
 3000 M$ = "VON WELCHEM ZEICHEN (1-4)?" 
 3010 Y = 24 
 3020 X = 3 
 3030 GOSUB 2800
 3040 FOR I = 1 TO 8 
 3050 FOR J = 1 TO 8 
 3060 B ( I , J , 0 ) = B ( I , J , KEEP ) 
 3070 NEXT J 
 3080 NEXT I 
 3090 GOSUB 3210
 3100 IF RX1 = 1 THEN 940
 3110 FOR I = 1 TO 8 
 3120 B ( I , 1 , 0 ) = 0 
 3130 B ( I , 7 , 0 ) = 0 
 3140 B ( I , 8 , 0 ) = 0 
 3150 NEXT I 
 3160 FOR I = 2 TO 6 
 3170 B ( 1 , I , 0 ) = 0 
 3180 NEXT I 
 3190 GOTO 940
 3200 REM  -SHOW IT- 
 3210 FOR I = RX1 TO RX2 
 3220 FOR J = CX1 TO CX2 
 3230 CALL HCHAR ( I + HY , J + HX , B ( I , J , 0 ) + 100 ) 
 3240 NEXT J 
 3250 NEXT I 
 3260 RETURN 
 3270 REM  -GET COLORS- 
 3280 CALL CLEAR 
 3281 PRINT "TI-99/4A  ZEICHEN DEFINITION" 
 3282 PRINT 
 3283 PRINT 
 3290 PRINT " 1=TRANSPARENT  2=SCHWARZ" 
 3291 PRINT 
 3300 PRINT " 3=MITTELGRUEN  4=HELLGRUEN" 
 3301 PRINT 
 3310 PRINT " 5=DUNKELBLAU   6=HELLBLAU" 
 3311 PRINT 
 3320 PRINT " 7=DUNKELROT    8=MITTELBLAU" 
 3321 PRINT 
 3330 PRINT " 9=MITTELROT   10=HELLROT" 
 3331 PRINT 
 3340 PRINT "11=DUNKELGELB  12=HELLGELB" 
 3341 PRINT 
 3350 PRINT "13=DUNKELGRUEN 14=MAGENTAROT" 
 3351 PRINT 
 3360 PRINT "15=GRAU        16=WEISS" 
 3361 PRINT 
 3370 PRINT 
 3371 PRINT 
 3380 PRINT "VORDERGRUNDFARBE (1-16)"  ; 
 3390 INPUT FOREGROUND 
 3400 IF FOREGROUND < 1 THEN 3390
 3410 IF FOREGROUND > 16 THEN 3390
 3420 PRINT "HINTERGRUNDFARBE (1-16)"  ; 
 3430 INPUT BACKGROUND 
 3440 IF BACKGROUND < 1 THEN 3430
 3450 IF BACKGROUND > 16 THEN 3430
 3460 RETURN 
