  500  !  ** SKIFAHREN **
  505 CALL CLEAR 
  510 ON WARNING NEXT 
  515 OPTION BASE 1 
  520 DIM H$ ( 20 ) , N$ ( 9 ) , HS ( 260 ) , TS ( 9 ) , RA ( 9 ) 
  525 S$ = "()      " & CHR$ ( 136 ) & CHR$ ( 137 ) 
  530 FOR I = 1 TO 19 
  535 H$ ( I ) = SEG$ ( "!!!!!!!!!!!!!!!!!!*+      " & CHR$ ( 138 ) & CHR$ ( 139 ) & "!!!!!!!!!!!!!!!!!!!" , I , 28 ) 
  540 NEXT I 
  545 DEF TP ( X ) = INT ( X / 60 ) 
  550 DEF TQ ( X ) = INT ( ( X - TP ( X ) * 60 ) * 100 ) / 100 
  555 REM  DEFINITION
  560 CALL CHAR ( 33 , "000000FFFF" , 128 , "0000001824C3" ) 
  565 Z$ = "070707070707040400C0F0F0C000000004040404040404040" 
  570 CALL CHAR ( 40 , Z$ , 136 , Z$ , 129 , "000000FFFF" , 64 , "000010107C101" ) 
  575 CALL CHAR ( 96 , "000707070F1F1315191101000000030E000000E0B19ACCC0C0C0C0EEF8E08" ) 
  580 CALL CHAR ( 100 , "000303071F3727272F37270606060202008080C0F0D8C8C8E8D8C8C0C0C0808" ) 
  585 CALL CHAR ( 104 , "000000078D593303030303771F07010000E0E0E0F0F8C8A8988880000000C07" ) 
  590 GOSUB 1540
  595 CALL SCREEN ( 12 )  :: DISPLAY ERASE ALL AT ( 6 , 2 )  : "ANZAHL SPIELER [1-9]?:1" 
  600 ACCEPT AT ( 6 , 24 ) BEEP VALIDATE ( DIGIT ) SIZE ( - 1 )  : SPIELER  :: IF SPIELER = 0 OR SPIELER > 9 THEN 600
  605 IF SPIELER = 1 THEN 640
  610 DISPLAY AT ( 9 , 1 )  : "NAMENSEINGABE :" 
  615 FOR G = 1 TO SPIELER 
  620 DISPLAY AT ( 10 + G , 1 )  : "SPIELER " & STR$ ( G ) & "?:" 
  625 ACCEPT AT ( 10 + G , 13 ) BEEP VALIDATE ( UALPHA , ".-" ) SIZE ( 8 )  : N$ ( G ) 
  630 IF N$ ( G ) = "" THEN 625
  635 NEXT G 
  640 CALL SCREEN ( 4 )  :: DISPLAY AT ( 9 , 1 ) ERASE ALL  : "GEBEN SIE DIE NUMMER DER    PISTE AN, AUF DER SIE FAHRENWOLLEN[1-9999]: 1" 
  645 ACCEPT AT ( 11 , 17 ) SIZE ( - 4 ) BEEP VALIDATE ( DIGIT )  : PSN  :: IF PSN = 0 THEN 645
  650 CALL CLEAR  :: CALL SCREEN ( 8 ) 
  655 DISPLAY AT ( 4 , 2 )  : "BITTE WAEHLEN SIE:"  :  : TAB ( 4 )  ; "1 ABFAHRT      \"  : TAB ( 20 )  ; ">EINFACH"  : TAB ( 4 )  ; "2 RIESENSLALOM /"  :  : TAB ( 4 )  ; "3 SLALOM       >SCHWIERIG" 
  660 CALL KEY ( 0 , K , S ) 
  665 IF K < 49 OR K > 51 THEN 660
  670 ON K - 48 GOTO 675, 685, 695
  675 F1 = 2  :: F2 = 8  :: F3 = 8 
  680 GOTO 700
  685 F1 = 3  :: F2 = 7  :: F3 = 7 
  690 GOTO 700
  695 F1 = 4  :: F2 = 3  :: F3 = 3 
  700 CALL CLEAR 
  705 CALL MAGNIFY ( 3 ) 
  710 CALL CLEAR  :: CALL SCREEN ( 14 ) 
  715 Z$ = "070707070707040400C0F0F0C000000004040404040404040" 
  720 IF K < > 51 THEN Z$ = "2030383F3F3F3F3F040C1CFCFCFCFCFC3F2F272020202020FCF4E40404040404" 
  725 CALL CHAR ( 40 , Z$ , 136 , Z$ ) 
  730 Z$ = "" 
  735 RANDOMIZE PSN 
  740 LS = INT ( 60 + 200 * RND )  :: SL = 1 
  745 DISPLAY AT ( 10 , 7 )  : "BITTE WARTEN"  :  : "[ PISTE NR."  ; PSN  ; "LAENGE:"  ; INT ( LS / F1 * 10 )  ; "M"  : "  WIRD GERADE PRAEPARIERT ]" 
  750 FOR I = 1 TO LS 
  755 HS ( I ) = INT ( 51 + RND * 100 ) 
  760 NEXT I 
  765 FOR I = 1 TO LS - 5 
  770 IF F1 = 1 THEN HS ( I ) = INT ( 19 * RND + 1 ) ELSE HS ( I ) = INT ( 10 + SGN ( SL ) * ( 3 + 6 * RND ) )  :: SL = - SL 
  775 HS ( I + 1 ) = HS ( I ) + 20 
  780 I = I + F2 + INT ( F3 * RND ) 
  785 NEXT I 
  790 CALL COLOR ( 0 , 2 , 8 , 1 , 16 , 16 , 2 , 7 , 16 , 3 , 2 , 16 , 4 , 2 , 16 , 5 , 2 , 16 , 6 , 2 , 16 ) 
  795 CALL COLOR ( 7 , 2 , 16 , 8 , 2 , 16 , 9 , 5 , 16 , 10 , 5 , 16 , 11 , 2 , 16 , 12 , 2 , 16 , 13 , 2 , 16 , 14 , 5 , 16 ) 
  800 CALL SCREEN ( 8 ) 
  805 REM  START
  810 FOR G = 1 TO 9  :: TS ( G ) , RA ( G ) = 0  :: NEXT G 
  815 FOR SP = 1 TO SPIELER 
  820 CALL CLEAR 
  825 CALL DELSPRITE ( ALL ) 
  830 CALL VCHAR ( 1 , 31 , 31 , 96 ) 
  835 IF SPIELER = 1 THEN 845
  840 DISPLAY AT ( 2 , 2 )  : "NR."  ; SP  ; " "  ; N$ ( SP ) 
  845 DISPLAY AT ( 6 , 1 )  : "          " & RPT$ ( CHR$ ( 129 ) , 7 ) & "                      START" 
  850 DISPLAY AT ( 14 , 1 )  : TAB ( 10 )  ; S$  : H$ ( 10 ) 
  855 CALL SPRITE ( # 1 , 100 , 3 + SP , 26 , 120 , 0 , 0 ) 
  860 ZIEL , T = 0 
  865 CALL KEY ( 1 , K , S ) 
  870 IF K < > 18 THEN 865
  875 FOR ZA = 1 TO 3 
  880 CALL SOUND ( 100 , 440 , 9 ) 
  885 CALL SOUND ( 100 , 110 , 30 ) 
  890 NEXT ZA 
  895 CALL SOUND ( 200 , 659 , 9 ) 
  900 SPD = 8 
  905 TZ = .2 
  910 CALL SOUND ( 4250 , - 5 , 29 ) 
  915 GOSUB 1370
  920 IF X THEN T = T + .5 
  925 CALL POSITION ( # 1 , P , Q ) 
  930 IF P < 56 THEN 915
  935 CALL MOTION ( # 1 , 0 , 0 ) 
  940 CALL LOCATE ( # 1 , 58 , Q ) 
  945 SPD = 0 
  950 FOR PS = 1 TO LS 
  955 TZ = 1 / F1 
  960 GOSUB 1370
  965 CALL POSITION ( # 1 , P , Q ) 
  970 P = ( P + 15 ) / 8 
  975 Q = ( Q + 11 ) / 8 
  980 IF Q < = 2 OR Q > = 31 THEN 1095
  985 CALL GCHAR ( P , Q , Z ) 
  990 IF Z = 32 OR Z = 128 THEN 1145
  995 IF Z = 33 OR ( Z = 139 AND F1 = 4 ) THEN 1015
 1000 IF Z = 129 THEN 1210
 1005 IF Z = 42 OR ( Z = 43 AND F1 < > 4 ) OR Z = 138 OR ( Z = 139 AND F1 < > 4 ) THEN 1040
 1010 GOTO 1145
 1015 CALL COLOR ( 1 , 15 , 16 ) 
 1020 CALL SOUND ( - 100 , 440 , 20 ) 
 1025 T = T + 1.5 
 1030 CALL COLOR ( 1 , 16 , 16 ) 
 1035 GOTO 1145
 1040 CALL HCHAR ( P , Q , 32 ) 
 1045 CALL PATTERN ( # 1 , 100 ) 
 1050 CALL PATTERN ( # 1 , 96 ) 
 1055 CALL PATTERN ( # 1 , 100 ) 
 1060 CALL PATTERN ( # 1 , 104 ) 
 1065 CALL SOUND ( - 100 , - 6 , 15 ) 
 1070 CALL PATTERN ( # 1 , 100 ) 
 1075 CALL PATTERN ( # 1 , 96 ) 
 1080 CALL PATTERN ( # 1 , 100 ) 
 1085 T = T + .1 
 1090 GOTO 1145
 1095 CALL MOTION ( # 1 , 0 , 0 ) 
 1100 CALL SOUND ( - 500 , - 6 , 10 ) 
 1105 FOR G = 1 TO 20 
 1110 CALL COLOR ( 0 , 2 , 10 ) 
 1115 CALL COLOR ( # 1 , 12 ) 
 1120 CALL COLOR ( 0 , 2 , 8 ) 
 1125 CALL COLOR ( # 1 , 5 ) 
 1130 NEXT G 
 1135 CALL DELSPRITE ( ALL ) 
 1140 GOTO 1320
 1145 CALL SOUND ( - 1500 , - 5 , 29 ) 
 1150 REM  PISTE
 1155 IF ZIEL THEN PRINT  :: GOTO 1185
 1160 WP = HS ( PS ) 
 1165 IF WP > 50 THEN 1180
 1170 IF WP < 20 THEN PRINT TAB ( 20 - WP )  ; S$ ELSE PRINT H$ ( WP - 20 ) 
 1175 GOTO 1185
 1180 IF WP < 79 THEN PRINT TAB ( WP - 50 )  ; CHR$ ( 128 ) ELSE PRINT  : 
 1185 NEXT PS 
 1190 ZIEL , PS = 1 
 1195 CALL HCHAR ( 23 , 3 , 129 , 28 )  :: PRINT TAB ( 12 )  ; "ZIEL" 
 1200 TZ = 0 
 1205 GOTO 950
 1210 TS ( SP ) = T 
 1215 CALL MOTION ( # 1 , 0 , 0 ) 
 1220 IF RA ( 1 ) = 0 THEN 1240
 1225 IMAGE "## : ##.##" 
 1230 IMAGE "##.##" 
 1235 DISPLAY AT ( 23 , 2 )  : USING 1225 : TP ( TS ( RA ( 1 ) ) ) , TQ ( TS ( RA ( 1 ) ) ) 
 1240 DISPLAY AT ( 23 , 15 )  : USING 1225 : TP ( TS ( SP ) ) , TQ ( TS ( SP ) ) 
 1245 SPD = 8 
 1250 IF SPIELER = 1 THEN 1275
 1255 DISPLAY AT ( 1 , 1 )  :  : " NR."  ; SP  ; N$ ( SP )  :  : 
 1260 GOSUB 1405
 1265 FOR G = 1 TO SPIELER  :: IF RA ( G ) = SP THEN DISPLAY AT ( 24 , 23 )  : "["  ; G  ; "]"  :: GOTO 1275
 1270 NEXT G  :: STOP 
 1275 TZ = 0 
 1280 SPD = 4 
 1285 FOR G = 1 TO 50  :: GOSUB 1370 :: NEXT G 
 1290 T = 0  :: CALL MOTION ( # 1 , 0 , 0 ) 
 1295 DISPLAY AT ( 14 , 4 )  : "DRUECKEN SIE EINE TASTE" 
 1300 CALL KEY ( 1 , K , S1 )  :: CALL KEY ( 0 , K , S ) 
 1305 IF S = 0 AND S1 = 0 THEN 1300
 1310 CALL DELSPRITE ( ALL ) 
 1315 IF K = 6 THEN 640ELSE IF K = 15 THEN 595
 1320 IF SP < 3 THEN 1330
 1325 GOSUB 1460
 1330 NEXT SP 
 1335 DISPLAY AT ( 12 , 5 ) ERASE ALL BEEP  : "NOCH EIN SPIEL ?[J/N]" 
 1340 CALL KEY ( 0 , K , S )  :: IF S < = 0 THEN 1340
 1345 IF K = 78 OR K = 110 THEN STOP 
 1350 IF K = 74 OR K = 106 THEN IF SPIELER = 1 THEN 815ELSE 810
 1355 GOTO 1340
 1360 STOP 
 1365 REM  SKIFAHRER
 1370 CALL JOYST ( 1 , X , Y ) 
 1375 T = T + TZ 
 1380 IF X THEN T = T + .01 
 1385 CALL PATTERN ( # 1 , X + 100 ) 
 1390 CALL MOTION ( # 1 , SPD , F1 * X ) 
 1395 RETURN 
 1400  !  RANGBERECHNUNG
 1405  ! 
 1410 FOR G = 1 TO SPIELER 
 1415 IF RA ( G ) = 0 THEN 1435
 1420 IF TS ( SP ) < = TS ( RA ( G ) ) THEN 1435
 1425 NEXT G 
 1430 STOP 
 1435 FOR I = SPIELER - 1 TO G STEP - 1 
 1440 RA ( I + 1 ) = RA ( I ) 
 1445 NEXT I 
 1450 RA ( G ) = SP 
 1455 RETURN 
 1460  !  AUSDRUCK
 1465 CALL DELSPRITE ( ALL ) 
 1470 CALL CLEAR 
 1475 DISPLAY AT ( 2 , 1 )  : "PL. STRNR. NAME      ZEIT" 
 1480 FOR G = 1 TO SPIELER 
 1485 IF RA ( G ) = 0 THEN 1520
 1490 IF G = 1 THEN TP1 = TP ( TS ( RA ( 1 ) ) )  :: TQ1 = TQ ( TS ( RA ( 1 ) ) )  :: P$ = " " ELSE TP1 = 0  :: TQ1 = TS ( RA ( G ) ) - TS ( RA ( 1 ) )  :: P$ = "@" 
 1495 IF G = 1 THEN G1 = G  :: GOTO 1505
 1500 IF TS ( RA ( G ) ) < > TS ( RA ( G - 1 ) ) THEN G1 = G 
 1505 DISPLAY AT ( 3 + G , 1 )  : G1  ; TAB ( 5 )  ; RA ( G )  ; TAB ( 10 )  ; N$ ( RA ( G ) )  ; TAB ( 19 )  ; P$ 
 1510 IF G > 1 THEN DISPLAY AT ( 3 + G , 24 )  : USING 1230 : TQ1 ELSE DISPLAY AT ( 3 + G , 19 )  : USING 1225 : TP1 , TQ1 
 1515 NEXT G 
 1520 DISPLAY AT ( 23 , 7 )  : "TASTE DRUECKEN" 
 1525 CALL KEY ( 1 , K , S1 )  :: CALL KEY ( 0 , K , S )  :: IF S < = 0 AND S1 < = 0 THEN 1525
 1530 RETURN 
 1535  !  ** TITEL **
 1540 CALL MAGNIFY ( 2 )  :: CALL SCREEN ( 16 ) 
 1545 CALL SPRITE ( # 1 , 83 , 2 , 20 , 128 , # 2 , 75 , 2 , 30 , 128 , # 3 , 73 , 2 , 60 , 128 ) 
 1550 CALL MOTION ( # 1 , 8 , - 8 , # 2 , - 8 , 0 , # 3 , - 8 , 8 ) 
 1555 CALL COINC ( # 1 , 40 , 108 , 2 , O )  :: IF NOT O THEN 1555
 1560 CALL MOTION ( # 1 , 0 , 0 , # 2 , 0 , 0 , # 3 , 0 , 0 ) 
 1565 CALL LOCATE ( # 1 , 40 , 108 , # 2 , 16 , 128 , # 3 , 40 , 148 ) 
 1570 CALL COLOR ( # 1 , 5 , # 2 , 7 , # 3 , 14 ) 
 1575 CALL MOTION ( # 2 , 8 , 0 ) 
 1580 CALL COINC ( # 2 , 40 , 128 , 2 , O )  :: IF NOT O THEN 1580
 1585 CALL MOTION ( # 2 , 0 , 0 )  :: CALL LOCATE ( # 2 , 40 , 128 ) 
 1590 DISPLAY AT ( 10 , 8 )  : "() HALLO " & CHR$ ( 136 ) & CHR$ ( 137 )  : TAB ( 8 )  ; "*+ HALLO " & CHR$ ( 138 ) & CHR$ ( 139 ) 
 1595 DISPLAY AT ( 13 , 1 )  : "LIEBE SKIFREUNDE,"  :  : "`b DER COMPUTER BEGRUESST hjac SIE ZUM SKIPROGRAMM.   ik" 
 1600 DISPLAY AT ( 18 , 1 )  : "HIER DIE REGELN:"  : "ES KOENNEN BIS ZU 9 FAHRER  TEILNEHMEN.JEDER GIBT SEINENNAMEN EIN UND ERHAELT EINE  STARTNUMMER." 
 1605 GOSUB 1665
 1610 CALL LOCATE ( # 1 , 1 , 108 , # 2 , 1 , 128 , # 3 , 1 , 148 ) 
 1615 PRINT  :  :  :  : "() ES WIR IMMER MIT JOYSTICK*+ NR.1 GESPIELT.AM ENDE       ERSCHEINT DANN DIE     " & CHR$ ( 136 ) & CHR$ ( 137 ) 
 1620 PRINT "   GEFAHRENE ZEIT UND EINE" & CHR$ ( 138 ) & CHR$ ( 139 ) & "`b RANGTABELLE." 
 1625 PRINT "ac"  ; TAB ( 27 )  ; "df"  : "   SIE MUESSEN VERSUCHEN  eg() SO DURCH DIE PISTE ZU"  : "*+ KOMMEN, OHNE DASS SIE  " & CHR$ ( 136 ) & CHR$ ( 137 ) 
 1630 PRINT "   EIN TOR STREIFEN ODER  " & CHR$ ( 138 ) & CHR$ ( 139 ) & "hj AUSLASSEN."  : "ik SONST ERHALTEN SIE          EINEN ZEITZUSCHLAG." 
 1635 PRINT  :  : RPT$ ( "()" & CHR$ ( 136 ) & CHR$ ( 137 ) , 2 ) & "    VIEL"  ; 
 1640 PRINT TAB ( 20 )  ; RPT$ ( "()" & CHR$ ( 136 ) & CHR$ ( 137 ) , 2 ) 
 1645 PRINT RPT$ ( "*+" & CHR$ ( 138 ) & CHR$ ( 139 ) , 2 ) & "   GLUECK"  ; TAB ( 20 )  ; RPT$ ( "*+" & CHR$ ( 138 ) & CHR$ ( 139 ) , 2 )  :  : 
 1650 GOSUB 1665
 1655 CALL DELSPRITE ( ALL )  :: CALL COLOR ( 2 , 2 , 1 ) 
 1660 RETURN 
 1665 DISPLAY AT ( 24 , 6 )  : "WEITER MIT ENTER" 
 1670 FOR J = 1 TO 3  :: CALL COLOR ( # J , INT ( 14 * RND + 2 ) )  :: NEXT J 
 1675 CALL COLOR ( 2 , INT ( 14 * RND + 2 ) , 1 )  :: CALL COLOR ( 9 , INT ( 14 * RND + 2 ) , 1 )  :: CALL COLOR ( 14 , INT ( 14 * RND + 2 ) , 1 )  :: CALL COLOR ( 10 , INT ( 14 * RND + 2 ) , 1 ) 
 1680 CALL KEY ( 0 , K , S )  :: IF S < = 0 OR K < > 13 THEN 1670
 1685 RETURN 
 1690 END 
