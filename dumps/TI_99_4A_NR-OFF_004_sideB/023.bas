  100 REM    PROGRAM: PEG JUMP
  110 REM    VERRSION 1 / GERMAN / NOV 1982
  120 REM    COPYRIGHT 1982 BY TEXAS INSTRUMENTS DEUTSCCHLAND GMBH
  130 DATA 10314 , 20316 , 30318 , 40514 , 50516 , 60518 , 70710 , 80712 , 90714 , A0716 , B0718 , C0720 , D0722 , E0910 , F0912 , G0914 , H0916 
  140 DATA I0918 , J0920 , K0922 , L1110 , M1112 , N1114 , O1116 , P1118 , Q1120 , R1122 , S1314 , T1316 , U1318 , V1514 , W1516 , X1518 
  150 OPTION BASE 1 
  160 DIM A$ ( 33 ) 
  170 FOR I = 1 TO 33 
  180 READ A$ ( I ) 
  190 NEXT I 
  200 CALL CLEAR 
  210 FOR I = 1 TO 12 
  220 CALL COLOR ( I , 2 , 8 ) 
  230 NEXT I 
  240 CALL COLOR ( 9 , 2 , 5 ) 
  250 CALL COLOR ( 10 , 2 , 8 ) 
  260 CALL COLOR ( 11 , 2 , 8 ) 
  270 CALL COLOR ( 12 , 2 , 7 ) 
  280 CALL CHAR ( 96 , "0" ) 
  290 CALL CHAR ( 34 , "3C4299A1A199423C" ) 
  295 CALL CHAR ( 36 , "00282828" ) 
  300 CALL CHAR ( 104 , "FF8080808080808" ) 
  310 CALL CHAR ( 105 , "FF" ) 
  320 CALL CHAR ( 106 , "808080808080808" ) 
  330 CALL CHAR ( 107 , "8" ) 
  340 CALL CHAR ( 108 , "000000000000FFFF" ) 
  350 CALL CHAR ( 109 , "FFFF" ) 
  360 CALL CHAR ( 110 , "C0C0C0C0C0C0C0C" ) 
  370 CALL CHAR ( 111 , "0303030303030303" ) 
  380 CALL CHAR ( 120 , "FF80808083878F8F" ) 
  390 CALL CHAR ( 121 , "FF000000C0E0F0F" ) 
  400 CALL CHAR ( 122 , "8F8F8F878380808" ) 
  410 CALL CHAR ( 123 , "0" ) 
  420 REM  TITLE SCREEN**** 
  430 GOSUB 1300
  440 PRINT "      SPRING UND NIMM!"  :  : "         (PEGJUMP)"  :  :  :  :  :  : "  "  ; CHR$ ( 34 )  ; " 1982 TEXAS INSTRUMENTS"  :  :  :  :  :  : 
  450 PRINT " IRGEND EINE TASTE DRUECKEN" 
  460 CALL KEY ( 0 , KEY , ST ) 
  470 IF ST < = 0 THEN 460
  480 GOSUB 1300
  490 REM  MAIN MENU****** 
  500 PRINT "      SPRING UND NIMM!"  :  :  : 
  510 CALL HCHAR ( 19 , 07 , 108 , 20 ) 
  520 CALL HCHAR ( 23 , 07 , 109 , 20 ) 
  530 CALL VCHAR ( 20 , 07 , 110 , 3 ) 
  540 CALL VCHAR ( 20 , 26 , 111 , 3 ) 
  550 PRINT  :  : "       BITTE WAEHLEN SIE:" 
  560 PRINT  :  : "   1   SPIELANLEITUNG" 
  570 PRINT  : "   2   NEUES SPIEL" 
  580 PRINT  : "   3   SPIEL BEENDEN"  :  :  :  :  :  :  : 
  590 CALL KEY ( 0 , KEY , ST ) 
  600 IF ST < = 0 THEN 590
  610 IF KEY > 48 THEN 640
  620 CALL SOUND ( 100 , 294 , 2 ) 
  630 GOTO 590
  640 IF KEY > 51 THEN 620
  650 GOSUB 1300
  660 IF KEY - 48 = 3 THEN 720
  670 IF KEY - 48 = 2 THEN 690
  680 GOSUB 2430
  690 GOSUB 730
  700 GOSUB 1810
  710 GOTO 700
  720 STOP 
  730 REM  MAKE BOARD******** 
  740 TAKEN = 0 
  750 LEFT = 32 
  760 GOSUB 1300
  770 CALL HCHAR ( 13 , 10 , 105 , 14 ) 
  780 CALL VCHAR ( 3 , 20 , 106 , 14 ) 
  790 FOR ROW = 3 TO 15 STEP 2 
  800 FOR COL = 14 TO 18 STEP 2 
  810 GOSUB 1680
  820 NEXT COL 
  830 NEXT ROW 
  840 FOR ROW = 7 TO 11 STEP 2 
  850 COL = 10 
  860 GOSUB 1680
  870 COL = 12 
  880 GOSUB 1680
  890 COL = 20 
  900 GOSUB 1680
  910 COL = 22 
  920 GOSUB 1680
  930 NEXT ROW 
  940 CALL HCHAR ( 17 , 14 , 105 , 6 ) 
  950 CALL VCHAR ( 7 , 24 , 106 , 6 ) 
  960 CALL HCHAR ( 13 , 20 , 104 ) 
  970 FOR I = 1 TO 33 
  980 CALL HCHAR ( 1 + VAL ( SEG$ ( A$ ( I ) , 2 , 2 ) ) , 1 + VAL ( SEG$ ( A$ ( I ) , 4 , 2 ) ) , ASC ( A$ ( I ) ) ) 
  990 NEXT I 
 1000 CALL HCHAR ( 13 , 24 , 107 ) 
 1010 CALL HCHAR ( 17 , 20 , 107 ) 
 1020 S$ = "STIFTE" 
 1030 ROW = 3 
 1040 COL = 3 
 1050 GOSUB 1380
 1060 COL = 23 
 1070 GOSUB 1380
 1080 S$ = "GENOMMEN" 
 1090 COL = 3 
 1100 GOSUB 1370
 1110 COL = 23 
 1120 S$ = "UEBRIG" 
 1130 GOSUB 1380
 1140 S$ = "   32" 
 1150 ROW = ROW + 2 
 1160 GOSUB 1380
 1170 COL = 4 
 1180 S$ = "0" 
 1190 GOSUB 1380
 1200 ROW = 9 
 1210 COL = 16 
 1220 GOSUB 1770
 1230 CALL HCHAR ( 5 , 4 , 105 , 8 ) 
 1240 CALL HCHAR ( 5 , 24 , 105 , 6 ) 
 1250 ROW = 19 
 1260 COL = 3 
 1270 S$ = "ZUG:  VON    AUF " 
 1280 GOSUB 1380
 1290 RETURN 
 1300 REM  SCREEN CLEAR*** 
 1310 CALL CLEAR 
 1320 CALL SCREEN ( 5 ) 
 1330 CALL VCHAR ( 1 , 1 , 96 , 48 ) 
 1340 CALL VCHAR ( 1 , 31 , 96 , 48 ) 
 1350 RETURN 
 1360 REM  DISPLAY MESSAGE****     
 1370 ROW = ROW + 1 
 1380 FOR N = 1 TO LEN ( S$ ) 
 1390 CALL HCHAR ( ROW , COL + N , ASC ( SEG$ ( S$ , N , 28 ) ) ) 
 1400 NEXT N 
 1410 RETURN 
 1420 REM  CURSOR**** 
 1430 ROW = 19 
 1440 CUR = BEG 
 1450 IF CUR > = BEG THEN 1480
 1460 CUR = BEG 
 1470 GOTO 1500
 1480 IF CUR < = IND THEN 1500
 1490 CUR = IND 
 1500 CALL GCHAR ( ROW , CUR , G ) 
 1510 CALL HCHAR ( ROW , CUR , 95 ) 
 1520 IF CURI < > 6 THEN 1550
 1530 CURI = 0 
 1540 CALL HCHAR ( ROW , CUR , G ) 
 1550 CURI = CURI + 1 
 1560 CALL KEY ( 0 , KEY , ST ) 
 1570 IF ST < = 0 THEN 1510
 1580 IF KEY = 12 THEN 2530
 1590 CALL HCHAR ( ROW , CUR , G ) 
 1600 IF KEY = 13 THEN 1670
 1610 IF KEY < 49 THEN 1450
 1620 IF KEY > 88 THEN 1450
 1630 IF KEY < 58 THEN 1650
 1640 IF KEY < 65 THEN 1450
 1650 CALL HCHAR ( ROW , CUR , KEY ) 
 1660 GOTO 1450
 1670 RETURN 
 1680 REM   MAKE PEG****  
 1690 CALL HCHAR ( ROW , COL , 120 ) 
 1700 CALL HCHAR ( ROW , COL + 1 , 121 ) 
 1710 CALL HCHAR ( ROW + 1 , COL , 122 ) 
 1720 RETURN 
 1730 REM  BLANK PEG**** 
 1740 CALL HCHAR ( TR1 , TC1 , 104 ) 
 1750 CALL HCHAR ( TR1 , TC1 + 1 , 105 ) 
 1760 CALL HCHAR ( TR1 + 1 , TC1 , 106 ) 
 1770 CALL HCHAR ( ROW , COL , 104 ) 
 1780 CALL HCHAR ( ROW , COL + 1 , 105 ) 
 1790 CALL HCHAR ( ROW + 1 , COL , 106 ) 
 1800 RETURN 
 1810 REM  MAKE MOVE******* 
 1820 BEG = 14 
 1830 IND = BEG 
 1840 GOSUB 1420
 1850 F$ = CHR$ ( G ) 
 1860 IF F$ = " " THEN 1840
 1870 BEG = 21 
 1880 IND = BEG 
 1890 GOSUB 1420
 1900 T$ = CHR$ ( G ) 
 1910 IF T$ = " " THEN 1890
 1920 REM  CHECK LEGAL**** 
 1930 FOR I = 1 TO 33 
 1940 IF SEG$ ( A$ ( I ) , 1 , 1 ) = F$ THEN 1960
 1950 NEXT I 
 1960 ROW = VAL ( SEG$ ( A$ ( I ) , 2 , 2 ) ) 
 1970 COL = VAL ( SEG$ ( A$ ( I ) , 4 , 2 ) ) 
 1980 CALL GCHAR ( ROW , COL , KEY ) 
 1990 IF KEY < > 120 THEN 1820
 2000 FOR I = 1 TO 33 
 2010 IF SEG$ ( A$ ( I ) , 1 , 1 ) = T$ THEN 2030
 2020 NEXT I 
 2030 TR = VAL ( SEG$ ( A$ ( I ) , 2 , 2 ) ) 
 2040 TC = VAL ( SEG$ ( A$ ( I ) , 4 , 2 ) ) 
 2050 CALL GCHAR ( TR , TC , KEY ) 
 2060 IF KEY < > 104 THEN 1820
 2070 IF TR = ROW THEN 2110
 2080 IF TR = ROW + 4 THEN 2240
 2090 IF TR = ROW - 4 THEN 2240
 2100 GOTO 1820
 2110 REM  TR=ROW** 
 2120 TR1 = ROW 
 2130 IF TC = COL + 4 THEN 2160
 2140 IF TC = COL - 4 THEN 2160
 2150 GOTO 1820
 2160 TC1 = ( COL + TC ) / 2 
 2170 CALL GCHAR ( TR1 , TC1 , KEY ) 
 2180 IF KEY < > 120 THEN 1820
 2190 GOSUB 1730
 2200 ROW = TR 
 2210 COL = TC 
 2220 GOSUB 1680
 2230 GOTO 2330
 2240 REM   TR=ROW+4****  
 2250 IF TC < > COL THEN 1820
 2260 TR1 = ( TR + ROW ) / 2 
 2270 TC1 = COL 
 2280 CALL GCHAR ( TR1 , TC1 , KEY ) 
 2290 IF KEY < > 120 THEN 1820
 2300 GOSUB 1730
 2310 ROW = TR 
 2320 GOSUB 1680
 2330 LEFT = LEFT - 1 
 2340 TAKEN = TAKEN + 1 
 2350 ROW = 6 
 2360 COL = 4 
 2370 S$ = STR$ ( TAKEN ) & " " 
 2380 GOSUB 1380
 2390 COL = 26 
 2400 S$ = STR$ ( LEFT ) & " " 
 2410 GOSUB 1380
 2420 RETURN 
 2430 REM  INSTRUCTIONS**** 
 2435 PRINT  : " MIT   $SPRING UND NIMM!$"  : " KANN MAN    $SOLITAIRE$" 
 2440 PRINT " SPIELEN. ES IST EIN ALTES"  : " LOGIKSPIEL MIT STIFTEN"  : " AUF EINEM KREUZFOERMIGEN"  : " SPIELFELD." 
 2460 PRINT  : " ZIEL IST ES, DURCH UEBER-"  : " SPRINGEN VON STIFTEN AUF"  : " FREIE FELDER, MOEGLICHST" 
 2470 PRINT " VIELE STIFTE ZU SCHLAGEN."  :  : 
 2480 PRINT  : " WENN SIE DAS SPIEL BEEN-"  : " DEN WOLLEN ODER KEINEN"  : " GUELTIGEN ZUG MEHR MACHEN" 
 2490 PRINT " KOENNEN, DRUECKEN SIE"  : " DIE FUNKTION $PROC'D$."  :  :  : " IRGEND EINE TASTE DRUECKEN" 
 2500 CALL KEY ( 0 , KEY , ST ) 
 2510 IF ST < = 0 THEN 2500
 2520 RETURN 
 2530 REM  SCORING***** 
 2540 GOSUB 1300
 2550 PRINT "          ERGEBNIS"  :  :  : 
 2560 CALL HCHAR ( 19 , 12 , 108 , 10 ) 
 2570 CALL HCHAR ( 23 , 12 , 109 , 10 ) 
 2580 CALL VCHAR ( 20 , 12 , 110 , 3 ) 
 2590 CALL VCHAR ( 20 , 21 , 111 , 3 ) 
 2600 PRINT  : "  IQ         STIFTE UEBRIG" 
 2610 PRINT  : "  GENIAL................ 1" 
 2620 PRINT  : "  FAST GENIAL..........2-4" 
 2630 PRINT  : "  SEHR KLUG..........  5-7" 
 2640 PRINT  : "  KLUG.................8-9" 
 2650 PRINT  : "  DURCHSCHNITT.......10-11" 
 2660 PRINT  :  : "  VIEL GLUECK IM NAECHSTEN"  : "  SPIEL." 
 2670 PRINT  : " IRGEND EINE TASTE DRUECKEN" 
 2680 CALL KEY ( 0 , KEY , ST ) 
 2690 IF ST < = 0 THEN 2680
 2700 GOTO 480
