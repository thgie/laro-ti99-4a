   10  !  ********************
   11  !  *                  *
   12  !  * ADRESSEN-        *
   13  !  *     VERZEICHNISS *
   14  !  *                  *
   15  !  ********************
   16  !  *  MARTIN  VOGLER  *
   17  !  ********************
   20 CALL CLEAR 
   21 A$ = "3C4299A1A199423C"  :: CALL CHAR ( 64 , A$ ) 
   22 CALL CHAR ( 128 , "FF8083838383BFBFFF01C1C1C1C1FDFDBFBF8383838380FFFDFDC1C1C1C101FF" ) 
   23 CALL CLEAR  :: CALL SCREEN ( 5 )  :: CALL COLOR ( 0 , 16 , 5 , 1 , 16 , 5 , 2 , 16 , 5 , 3 , 16 , 5 , 4 , 16 , 5 , 5 , 16 , 5 , 6 , 16 , 5 , 7 , 16 , 5 , 8 , 16 , 5 ) 
   24 CALL COLOR ( 13 , 16 , 9 )  :: DISPLAY AT ( 1 , 11 )  : "19" 
   25 CALL HCHAR ( 1 , 16 , 128 )  :: CALL HCHAR ( 1 , 17 , 129 )  :: CALL HCHAR ( 2 , 16 , 130 )  :: CALL HCHAR ( 2 , 17 , 131 )  :: DISPLAY AT ( 1 , 17 )  : "84" 
   26 DISPLAY AT ( 5 , 8 )  : "MARTIN VOGLER"  :  : "   HOMECOMPUTER TI-99/4A" 
   27 DISPLAY AT ( 15 , 1 )  : "     adressverzeichniss" 
   28 DISPLAY AT ( 16 , 1 )  : "     ------------------" 
   29 DISPLAY AT ( 24 , 6 )  : "** MOMENT BITTE **" 
   30 FOR VERZOEG = 1 TO 1000  :: NEXT VERZOEG  :: CALL CLEAR  :: CALL CHARSET 
   31 CALL SCREEN ( 4 ) 
   32 CALL COLOR ( 0 , 2 , 4 )  :: CALL COLOR ( 1 , 2 , 4 )  :: CALL COLOR ( 2 , 2 , 4 )  :: CALL COLOR ( 3 , 2 , 4 )  :: CALL COLOR ( 4 , 2 , 4 ) 
   33 CALL COLOR ( 5 , 2 , 4 )  :: CALL COLOR ( 6 , 2 , 4 )  :: CALL COLOR ( 7 , 2 , 4 )  :: CALL COLOR ( 8 , 2 , 4 )  :: CALL COLOR ( 9 , 2 , 4 )  :: CALL COLOR ( 10 , 2 , 4 ) 
   34 CALL COLOR ( 11 , 2 , 4 )  :: CALL COLOR ( 12 , 2 , 4 )  :: CALL COLOR ( 13 , 2 , 4 )  :: CALL COLOR ( 14 , 2 , 4 ) 
  100 DIM D$ ( 5 , 200 ) 
  110 CALL CLEAR 
  120 PRINT "ADRESSENKARTEI"  : "--------------"  :  :  :  :  :  : 
  130 PRINT "WAHLLISTE:"  :  : "1- DATEN VON KASSETTE LADEN"  : "2- DATEN SUCHEN"  : "3- KATALOG" 
  140 PRINT "4- NEUE DATEN EINGEBEN"  : "5- DATEN AUF KASSETTE SPEI-"  : "    CHERN"  : "6- DATEN AUSDRUCKEN"  : "7- ENDE"  :  :  :  :  : 
  150 CALL SOUND ( 150 , 1400 , 5 ) 
  160 CALL KEY ( 0 , K , S ) 
  170 IF S = 0 THEN 160
  180 IF K < 49 THEN 160
  190 IF K > 55 THEN 160
  200 CALL CLEAR 
  210 ON K - 48 GOTO 220, 300, 1350, 810, 730, 630, 2110
  220 OPEN # 1  : "CS1" , INTERNAL , INPUT , FIXED 192 
  230 INPUT # 1  : A 
  240 FOR D = 1 TO A STEP 2 
  250 INPUT # 1  : D$ ( 1 , D ) , D$ ( 2 , D ) , D$ ( 3 , D ) , D$ ( 4 , D ) , D$ ( 5 , D ) , D$ ( 1 , D + 1 ) , D$ ( 2 , D + 1 ) , D$ ( 3 , D + 1 ) , D$ ( 4 , D + 1 ) , D$ ( 5 , D + 1 ) 
  260 NEXT D 
  270 CLOSE # 1 
  280 CALL CLEAR 
  290 GOTO 130
  300 PRINT "WAHLLISTE:"  :  : "1- GANZE ZEILE SUCHEN"  : "2- NAMENSTEIL SUCHEN"  : "3- STRASSE SUCHEN"  : "4- ORT SUCHEN"  : 
  310 PRINT "5- TELEFONNUMMER SUCHEN"  : "6- KENNWORT SUCHEN" 
  320 CALL SOUND ( 150 , 1400 , 5 ) 
  330 CALL KEY ( 0 , K , S ) 
  340 IF S = 0 THEN 330
  350 IF K < 49 THEN 330
  360 IF K > 54 THEN 330
  370 ON K - 48 GOTO 380, 1550, 1590, 1630, 1670, 1710
  380 INPUT "BITTE EINE ZEILE EINGEBEN   "  : Z$ 
  390 PRINT  :  : "DURCH DRUECKEN EINER"  : "TASTE KOENNEN SIE DIE"  : "NAECHSTE DATEINUMMER"  : "MIT "  ; "'"  ; Z$  ; "'"  : "ABRUFEN."  :  :  : 
  400 FOR I = 1 TO A 
  410 FOR J = 1 TO 5 
  420 IF Z$ = D$ ( J , I ) THEN 430ELSE 440
  430 GOSUB 1130
  440 NEXT J 
  450 NEXT I 
  460 PRINT  :  : "KEINE WEITEREN DATEN MIT"  : "'"  ; Z$  ; "'"  ; " GEFUNDEN." 
  470 GOTO 520
  480 PRINT "DATEINUMMER"  ; I  :  : 
  490 FOR C = 1 TO 5 
  500 PRINT D$ ( C , I ) 
  510 NEXT C 
  520 PRINT  :  : "WAHLLISTE:"  :  : "1- DATEN VERAENDERN"  : "2- DATEN AUSDRUCKEN"  : "4- WEITER" 
  530 CALL SOUND ( 150 , 1400 , 5 ) 
  540 CALL KEY ( 0 , K , S ) 
  550 IF S = 0 THEN 540
  560 IF K = 49 THEN 1200
  570 IF K = 50 THEN 630
  580 IF K = 51 THEN 1350
  590 IF K = 52 THEN 610
  600 GOTO 540
  610 CALL CLEAR 
  620 GOTO 130
  630 PRINT "IST EIN DRUCKER ANGE-"  : "SCHLOSSEN? <J/N>" 
  640 CALL SOUND ( 150 , 1400 , 5 ) 
  650 CALL KEY ( 0 , K , S ) 
  660 IF S = 0 THEN 650
  670 IF K < > 74 THEN 520
  680 GOTO 1870
  690 IF I > = 3 THEN 710
  700 I = 3 
  710 I = I - 2 
  720 GOTO 1460
  730 OPEN # 1  : "CS1" , INTERNAL , OUTPUT , FIXED 192 
  740 PRINT # 1  : A 
  750 FOR D = 1 TO A STEP 2 
  760 PRINT # 1  : D$ ( 1 , D ) , D$ ( 2 , D ) , D$ ( 3 , D ) , D$ ( 4 , D ) , D$ ( 5 , D ) , D$ ( 1 , D + 1 ) , D$ ( 2 , D + 1 ) , D$ ( 3 , D + 1 ) , D$ ( 4 , D + 1 ) , D$ ( 5 , D + 1 ) 
  770 NEXT D 
  780 CLOSE # 1 
  790 CALL CLEAR 
  800 GOTO 130
  810 PRINT "GEBEN SIE BIS ZU 5 ZEILEN   EIN.DRUECHEN SIE EINFACH DIETASTE ENTER,WENN SIE EINE" 
  820 PRINT "LEERZEILE MOECHTEN. WENN"  : "SIE KEINE EINGABE MEHR"  : "MACHEN WOLLEN,GEBEN SIE"  : "'ENDE' EIN.DANKE!"  :  :  : 
  830 A = A + 1 
  840 Y$ ( 1 ) = "NAME" 
  850 Y$ ( 2 ) = "STRASSE" 
  860 Y$ ( 3 ) = "ORT" 
  870 Y$ ( 4 ) = "TELEFONNUMMER" 
  880 Y$ ( 5 ) = "KENNWORT" 
  890 FOR Z = 1 TO 5 
  900 PRINT Y$ ( Z ) 
  910 INPUT D$ ( Z , A ) 
  920 IF D$ ( Z , A ) = "ENDE" THEN 1110
  930 IF LEN ( D$ ( Z , A ) ) < = 28 THEN 970
  940 CALL SOUND ( 150 , 220 , 0 ) 
  950 PRINT  : " *EINGEGEBENE ZEILE IST ZU"  : "  LANG.(MAXIMAL 28)"  :  : " *NEUE ZEILE EINGEBEN"  :  : 
  960 GOTO 900
  970 NEXT Z 
  980 IF A / 2 < > INT ( A / 2 ) THEN 1080
  990 FOR T = 1 TO 5 
 1000 H = H + LEN ( D$ ( T , A ) ) + LEN ( D$ ( T , A - 1 ) ) 
 1010 NEXT T 
 1020 IF H < 192 THEN 1080
 1030 FOR T = 1 TO 5 
 1040 D$ ( T , A + 1 ) = D$ ( T , A ) 
 1050 D$ ( T , A ) = "**" 
 1060 NEXT T 
 1070 A = A + 1 
 1080 H = 0 
 1090 PRINT  :  : 
 1100 GOTO 830
 1110 CALL CLEAR 
 1120 GOTO 130
 1130 PRINT  : "DATEINUMMER"  ; I  :  : 
 1140 FOR C = 1 TO 5 
 1150 PRINT D$ ( C , I ) 
 1160 NEXT C 
 1170 CALL KEY ( 0 , K , S ) 
 1180 IF S = 0 THEN 1170
 1190 RETURN 
 1200 PRINT "WELCHE DATEINUMMER"  ; 
 1210 INPUT I 
 1220 FOR C = 1 TO 5 
 1230 PRINT  : D$ ( C , I ) 
 1240 NEXT C 
 1250 PRINT  :  :  : "WELCHE ZEILE KORRIGIEREN?(1-5)" 
 1260 CALL SOUND ( 150 , 1400 , 5 ) 
 1270 CALL KEY ( 0 , K , S ) 
 1280 IF S = 0 THEN 1270
 1290 IF K < 49 THEN 1270
 1300 IF K > 53 THEN 1270
 1310 PRINT  :  : "BISHERIGE ZEILE:"  : D$ ( K - 48 , I )  :  : 
 1320 INPUT "KORRIGIERTE ZEILE EINGEBEN: "  : D$ ( K - 48 , I ) 
 1330 CALL CLEAR 
 1340 GOTO 480
 1350 CALL CLEAR 
 1360 INPUT "AB WELCHER KARTEINUMMER WOL-LEN SIE BLAETTERN? "  : I 
 1370 CALL CLEAR 
 1380 PRINT "BLAETTERN"  :  :  :  : 
 1390 PRINT "1-VORWAERTS"  : "2- RUECKWAERTS"  : "3- BLAETTERN ENDE" 
 1400 CALL SOUND ( 150 , 1400 , 5 ) 
 1410 CALL KEY ( 0 , K , S ) 
 1420 IF S = 0 THEN 1410
 1430 IF K = 51 THEN 1520
 1440 IF K = 50 THEN 690
 1450 IF K < > 49 THEN 1410
 1460 PRINT  : "DATEINUMMER "  ; I  :  :  : 
 1470 FOR C = 1 TO 5 
 1480 PRINT D$ ( C , I ) 
 1490 NEXT C 
 1500 I = I + 1 
 1510 GOTO 1410
 1520 CALL CLEAR 
 1530 GOTO 520
 1540 PRINT "KEINE WEITEREN DATEN MIT"  : Z$  ; "GEFUNDEN!" 
 1550 C = 1 
 1560 CALL CLEAR 
 1570 INPUT "BITTE NAMEN EINGEBEN:       "  : Z$ 
 1580 GOTO 1740
 1590 C = 2 
 1600 CALL CLEAR 
 1610 INPUT "BITTE STRASSE EINGEBEN:     "  : Z$ 
 1620 GOTO 1740
 1630 C = 3 
 1640 CALL CLEAR 
 1650 INPUT "BITTE ORT EINGEBEN:         "  : Z$ 
 1660 GOTO 1740
 1670 C = 4 
 1680 CALL CLEAR 
 1690 INPUT "BITTE TELEFONNUMMER ANGEBEN:"  : Z$ 
 1700 GOTO 1740
 1710 C = 5 
 1720 CALL CLEAR 
 1730 INPUT "BITTE KENNWORT EINGEBEN:    "  : Z$ 
 1740 FOR I = 1 TO A 
 1750 F = 28 - LEN ( Z$ ) 
 1760 FOR L = 1 TO F 
 1770 M = LEN ( Z$ ) 
 1780 IF SEG$ ( D$ ( C , I ) , L , M ) = Z$ THEN 1790ELSE 1840
 1790 PRINT "DATEINUMMER "  ; I  :  : 
 1800 FOR T = 1 TO 5 
 1810 PRINT D$ ( T , I ) 
 1820 NEXT T 
 1830 GOTO 1850
 1840 NEXT L 
 1850 NEXT I 
 1860 GOTO 460
 2110 PRINT "WENN SIE DAS PROGRAMM"  : "BEENDEN, WERDEN ALLE DATEN"  : "GELOESCHT"  :  :  :  : 
 2120 PRINT "WAHLLISTE"  :  : "1- ENDE"  : "2- WEITER"  :  :  :  : 
 2130 CALL SOUND ( 150 , 1400 , 5 ) 
 2140 CALL KEY ( 0 , K , S ) 
 2150 IF S = 0 THEN 2140
 2160 IF K = 49 THEN 2210
 2170 IF K = 50 THEN 2190
 2180 GOTO 2140
 2190 CALL CLEAR 
 2200 GOTO 130
 2210 CALL CLEAR 
 2220 END 
