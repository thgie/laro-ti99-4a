   50 DISPLAY ERASE ALL  :: CALL SCREEN ( 12 )  :: RESTORE  :: DIM A$ ( 34 ) , B$ ( 34 ) , D$ ( 34 ) , R ( 34 , 4 )  :: FOR X = 1 TO 34  :: READ B$ ( X )  :: NEXT X  :: FOR X = 1 TO 34  :: FOR Y = 1 TO 4  :: READ R ( X , Y )  :: NEXT Y  :: NEXT X  :: FOR X = 1 TO 34  :: READ D$ ( X )  :: NEXT X 
   55 DEF RN ( X ) = INT ( X * RND + 1 )  :: RANDOMIZE  :: FOR X = 1 TO 34  :: A$ ( X ) = ""  :: NEXT X  :: ON ERROR 1500
   60 FOR O = 1 TO 5  :: U ( O ) = RN ( 34 )  :: NEXT O  :: FOR O = 1 TO 5  :: FOR V = O + 1 TO 5  :: IF U ( O ) = U ( V ) OR U ( O ) = 7 OR U ( O ) = 22 OR U ( O ) = 2 OR U ( O ) = 3 OR U ( O ) = 15 OR U ( O ) = 8 OR U ( O ) = 23 THEN 60
   65 NEXT V  :: NEXT O 
   70 D$ ( 1 ) = D$ ( U ( 1 ) )  :: READ D$ ( U ( 1 ) )  :: D$ ( 5 ) = D$ ( U ( 2 ) )  :: READ D$ ( U ( 2 ) )  :: D$ ( 6 ) = D$ ( U ( 3 ) )  :: READ D$ ( U ( 3 ) )  :: D$ ( 12 ) = D$ ( U ( 4 ) )  :: READ D$ ( U ( 4 ) )  :: D$ ( 30 ) = D$ ( U ( 5 ) )  :: READ D$ ( U ( 5 ) ) 
   75 A$ ( 20 ) = "MANCHMAL ENTKOMMT MAN NACH  NORDEN."  :: A$ ( 9 ) = "DER SIEHT MUEDE AUS."  :: A$ ( 22 ) = "UNTERSUCHEN SIE DIE UMGEBUNG" 
   80 A$ ( 2 ) = "DER IST EIN FEINSCHMECKER."  :: A$ ( 8 ) = "VORSICHTIG!!"  :: A$ ( 23 ) = "DA MUESSEN STARKE LEUTE RAN."  :: A$ ( 34 ) = "EINEN SPEER BESITZEN WAERE  HIER GEFAEHRLICH." 
   90 PRINT "ZUM PROGRAMMSTART <ENTER>"  :  : "VIEL GLUECK!"  :: P = 1  :: I = 0  :: ACCEPT I$ 
  100 DISPLAY ERASE ALL 
  110 PRINT  : "ICH BEFINDE MICH "  ; B$ ( P )  : "ICH SEHE "  ; D$ ( P )  : "MOEGLICHE WEGE:"  :: IF P = 20 THEN PRINT "NORD SUED OST WEST"  :: GOTO 160
  120 IF R ( P , 1 ) THEN PRINT "NORD "  ; 
  130 IF R ( P , 2 ) THEN PRINT "SUED "  ; 
  140 IF R ( P , 3 ) THEN PRINT "OST "  ; 
  150 IF R ( P , 4 ) THEN PRINT "WEST " 
  160 PRINT  :  :  :: GOSUB 1330
  170 IF G$ = "NOR" OR G$ = "SUE" OR G$ = "OST" OR G$ = "WES" THEN 1140
  180 IF G$ = "SUE" THEN P = P + R ( P , 2 )  :: GOTO 100ELSE IF G$ = "NOR" THEN P = P + R ( P , 1 )  :: GOTO 100ELSE IF G$ = "WES" THEN P = P + R ( P , 4 )  :: GOTO 100ELSE IF G$ = "OST" THEN P = P + R ( P , 3 )  :: GOTO 100
  190 IF G$ = "HIL" THEN IF A$ ( P ) = "" THEN PRINT "NICHTS ZU SAGEN."  :: GOTO 110ELSE PRINT A$ ( P )  :: GOTO 110
  200 IF G$ = "LIS" THEN 1040
  210 IF G$ = F$ THEN PRINT "UNVOLLSTAENDIGE EINGABE."  : "NOCH EINMAL:"  :: GOTO 110
  220 Y = POS ( "NEH,GEB,WER,LEG,LES,UNT,BET,SIE,DRU,PRE,ZIE,ENT,LOE,TOE,GRE,TRE,BEI,STR,KUE,ESS,TRI,RUD,SCH,OEF,SAG,SET" , F$ , 1 ) 
  230 IF Y AND ( Y + 3 ) / 4 = INT ( Y + 3 ) / 4 THEN 240ELSE PRINT "DAS VERSTEHE ICH NICHT:"  : I$  :: GOTO 110
  240 ON ( Y + 3 ) / 4 GOTO 270, 430, 430, 430, 540, 570, 570, 570, 740, 740, 760, 780, 800, 830, 830, 830, 830, 870, 870, 880, 900, 930, 960, 990, 400, 1030
  270 IF I = 6 THEN PRINT "ICH HABE ZUVIELE DINGE BEI  MIR. BITTE LISTE EINSEHEN."  :: GOTO 110
  280 IF P = 8 AND G$ = "SCH" THEN PRINT "DIE SCHLANGE HAT MICH"  : "GEBISSEN !"  :: P = 15  :: GOTO 110
  290 IF Q = 1 AND P = 15 AND G$ = "SPR" THEN M = 1  :: PRINT "OK."  :: GOTO 110
  300 X = POS ( D$ ( P ) , " " , 1 ) 
  310 IF G$ = SEG$ ( D$ ( P ) , X + 1 , 3 ) THEN 330
  320 PRINT "DAS KANN ICH NICHT !"  :: GOTO 110
  330 IF P = 23 AND G$ = "SCH" THEN IF W = 1 THEN C = 1 ELSE PRINT "DER SCHLUESSEL IST AM BODEN BEFESTIGT."  :: GOTO 110
  340 IF P = 3 AND G$ = "FLA" AND G = 1 THEN F = 1 
  350 IF G$ = "EIS" THEN E = 2 
  360 IF P = 2 AND G$ = "SCH" THEN [ = 1 
  370 IF G$ = "LAM" THEN L = 1 
  380 IF G$ = "SPE" THEN @ = 1 
  390 I = I + 1  :: CALL R ( "0" & STR$ ( P ) , 2 , Y$ )  :: L$ ( I ) = D$ ( P ) & Y$  :: D$ ( P ) = "NICHTS."  :: GOTO 100
  400 IF P = 28 AND G$ = "AGD" THEN PRINT "EINE TUERE OEFFNET SICH."  : "ICH GEHE HINAUS UND BIN"  : "ENTKOMMEN."  :  : "HERZLICHEN GLUECKWUNSCH !!"  :: STOP 
  410 IF G$ = "HAL" AND P = 9 THEN PRINT "ICH HABE EINEN BAUM AUFGE-  WECKT. ER SCHMEISST MIT"  : "AEPFELN !!!"  :: P = 15  :: GOTO 110
  420 PRINT E$  ; " !!"  :  : "  NICHTS PASSIERT"  :: GOTO 110
  430 FOR X = 1 TO I  :: GOSUB 1250 :: IF ] < > 1 THEN 440
  435 CALL R ( L$ ( X ) , 2 , Y$ )  :: O = VAL ( Y$ )  :: D$ ( O ) = SEG$ ( L$ ( X ) , 1 , LEN ( L$ ( X ) ) - 2 )  :: FOR Y = X TO I - 1  :: L$ ( Y ) = L$ ( Y + 1 )  :: NEXT Y  :: I = I - 1  :: GOTO 450
  440 NEXT X  :: PRINT "DAS HABE ICH NICHT BEI MIR."  :: GOTO 110
  450 IF P = 7 AND G$ = "MUE" THEN PRINT "DER SEE ZEIGT DIR DAS WORT  'AGDAR'."  :: GOTO 110ELSE IF P = 7 THEN PRINT "DER SEE IST WUETEND UND"  : "SCHMEISST MIT WELLEN NACH   DIR."  :: P = 15  :: GOTO 110
  460 CALL R ( L$ ( X ) , 2 , Y$ )  :: \ = VAL ( Y$ )  :: IF \ = 2 AND G$ = "SCH" THEN [ = 0 
  470 IF \ = 23 AND G$ = "SCH" THEN C = 0 
  480 IF G$ = "EIS" AND P = 2 THEN PRINT "DER RITTER FREUT SICH SO"  : "SEHR,DASS ER MIR SEIN"  : "SCHWERT SCHENKT."  :: D$ ( 2 ) = "EIN SCHWERT."  :: GOTO 110
  490 IF G$ = "EIS" THEN 110
  500 IF G$ = "LAM" THEN L = 0 
  510 IF G$ = "SPE" THEN @ = 0 
  520 IF G$ = "KNO" AND P = 32 THEN PRINT "EIN HUND ERSCHEINT,"  : "FRISST DEN KNOCHEN"  : "UND SCHLAEFT EIN."  :: H = 1  :: GOTO 110
  530 PRINT "DER GAERTNER RAEUMT ES WEG."  :: GOTO 110
  540 FOR X = 1 TO I  :: GOSUB 1250 :: IF ] = 1 THEN 550
  545 NEXT X  :: PRINT "HABE ICH NICHT BEI MIR !!"  :: GOTO 110
  550 IF G$ = "ZET" THEN PRINT "AUF DEM ZETTEL STEHT:"  : "NACH NORDEN,SUEDEN,OSTEN,   WESTEN,ENTKOMMST DU JENEM   RAUM AM BESTEN."  :: GOTO 110
  560 PRINT "ES IST NICHTS ZU ERKENNEN !!"  :: GOTO 110
  570 IF P = 22 AND G$ = "FEU" THEN PRINT "ICH HABE EINEN KNOCHEN GE-  FUNDEN."  :: D$ ( P ) = "EINEN KNOCHEN."  :: GOTO 110
  580 IF P = 8 AND G$ = "SCH" THEN PRINT "DIE SIEHT ZIEMLICH FEIGE AUS"  :: GOTO 110
  590 IF G$ = "ZET" THEN GOSUB 1250 :: IF ] = 1 THEN PRINT "DA STEHT WAS DRAUF !!"  :: GOTO 110
  600 IF D$ ( P ) = "EINEN ALTAR." AND G$ = "ALT" THEN PRINT "DER SIEHT BEWEGLICH AUS."  :: GOTO 110
  610 IF D$ ( P ) = "SPUREN." AND G$ = "SPU" THEN PRINT "DIE SIND UNHEIMLICH ALT."  :: GOTO 110
  620 GOSUB 1250
  630 IF G$ = "MUE" AND ( D$ ( P ) = "EINE MUENZE." OR ] ) THEN PRINT "SIEHT SO AUS, ALS HAETTE DIELANGE IM WASSER GELEGEN."  :: GOTO 110
  640 IF G$ = "TIS" AND ( D$ ( P ) = "EINEN TISCH." OR ] ) THEN PRINT "DER IST VOLLER BLUT!"  :: GOTO 110
  650 IF G$ = "BAE" AND ( ] OR D$ ( P ) = "ZWEI BAEREN." ) THEN PRINT "DIE SEHEN STARK AUS."  :: GOTO 110
  655 IF G$ = "SCH" AND [ = 2 AND D$ ( P ) = "EINE SCHLANGE." THEN PRINT "SIEHT FURCHTEINFLOESSEND AUS"  :: GOTO 110
  660 IF G$ < > "HEU" THEN IF ] OR POS ( D$ ( P ) , G$ , 1 ) < > 0 THEN PRINT "NICHTS ZU SEHEN."  :: GOTO 110ELSE PRINT "HABE ICH NICHT."  :: GOTO 110
  670 PRINT "BEI DER UNTERSUCHUNG BIN ICHEINGESCHLAFEN. INZWISCHEN   WURDE ICH WEGGETRAGEN."  :: ON RN ( 4 ) GOTO 680, 690, 700, 710
  680 P = 24  :: GOTO 110
  690 P = 30  :: GOTO 110
  700 P = 19  :: GOTO 110
  710 P = 3  :: GOTO 110
  740 IF G$ = "FAS" THEN PRINT "DAS FASS ZERSPLITTERT. EIN  SPEER FAELLT HINAUS."  :: D$ ( P ) = "EIN SPEER."  :: GOTO 110
  750 PRINT "DA RUEHRT SICH NICHTS !"  :: GOTO 110
  760 IF G$ = "ALT" AND D$ ( P ) = "EINEN ALTAR." THEN PRINT "DER ALTAR IST UMGESTUERZT.  UNTER IHM LAG EIN FEUERZEUG."  :: D$ ( P ) = "EIN FEUERZEUG."  :: GOTO 110
  770 PRINT "ES ZEIGEN SICH KEINE VERAEN-DERUNGEN."  :: GOTO 110
  780 IF G$ = "LAM" AND L > 0 THEN PRINT "WOMIT,"  ;  :: GOSUB 1330 :: IF G$ = "FEU" THEN GOSUB 1250 :: IF ] = 1 THEN PRINT "DIE LAMPE LEUCHTET MIT"  : "GELBEM LICHT."  :: L = 2  :: GOTO 110
  790 GOTO 1050
  800 IF L = 2 AND G$ = "LAM" THEN L = 1  :: PRINT "DIE LAMPE IST VERLOSCHEN."  :: GOTO 110
  810 IF L < 2 AND G$ = "LAM" THEN PRINT "WO IST HIER EINE LAMPE?"  :: GOTO 110
  820 GOTO 1050
  830 IF P = 2 AND G$ = "RIT" THEN PRINT "DER RITTER SCHLAEGT DICH"  : "NIEDER."  :: P = 15  :: GOTO 110
  840 IF G$ = "SCH" AND P = 8 THEN PRINT "DIE SCHLANGE FLIEHT UND"  : "VERLIERT EIN EIS."  :: D$ ( 8 ) = "EIN EIS."  :: E = 1  :: GOTO 110
  850 IF G$ = "BAE" THEN PRINT "DIE BAEREN SIND STAERKER ALSDU."  :: GOTO 110
  860 GOTO 1050
  870 PRINT "GEFAEHRLICHE BAZILLEN HABEN DICH UEBERFALLEN!!!"  :: P = 15  :: GOTO 110
  880 GOSUB 1250 :: IF ] = 1 THEN IF E = 2 AND G$ = "EIS" THEN PRINT "MHH!!! LECKER !!"  : "VANILLE-GESCHMACK !!"  :: E = 0  :: F$ = "WER"  :: G$ = "EIS"  :: GOTO 430
  890 GOTO 1050
  900 IF P = 7 OR P = 17 THEN PRINT "AHH !! DAS ERFRISCHT !!"  :: GOTO 110
  910 IF F = 0 THEN 1050
  920 IF G$ < > "FLA" THEN 1050ELSE PRINT "DER INHALT WAR GIFTIG !!"  :: P = 15  :: GOTO 110
  930 IF D$ ( P ) < > "EIN BOOT." THEN PRINT "ICH SEHE HIER KEIN BOOT !"  :: GOTO 110
  940 IF P = 7 THEN Z = 1  :: PRINT "OK. DAS HABE ICH GETAN." ELSE IF P = 17 THEN PRINT "DER FLUSS IST MIR ZU"  : "REISSEND." ELSE 1050
  950 GOTO 110
  960 IF C = 0 THEN PRINT "ICH HABE KEINEN SCHLUESSEL."  :: GOTO 110
  970 IF P = 27 AND G$ = "AUF" THEN PRINT "DIE TUER IST GEOEFFNET!!"  :: N = 1  :: GOTO 110
  980 GOTO 320
  990 IF P = 15 AND G$ = "ARZ" THEN PRINT "ES LIEGT EINE SPRITZE DARIN!"  :: Q = 1  :: GOTO 110
 1000 IF P = 3 AND G$ = "GRA" THEN PRINT "IN DEM GRAB LIEGT EINE"  : "FLASCHE."  :: G = 1  :: D$ ( 3 ) = "EINE FLASCHE."  :: GOTO 110
 1010 IF G$ = "FAS" THEN PRINT "ES IST VERNAGELT."  :: GOTO 110
 1020 GOTO 1050
 1030 IF G$ = "SCH" THEN PRINT "EIN SEIL IST GERISSEN."  :: P = 15  :: GOTO 110
 1040 PRINT "ICH HABE BEI MIR:"  :: FOR X = 1 TO I  :: PRINT SEG$ ( L$ ( X ) , 1 , LEN ( L$ ( X ) ) - 2 )  :: NEXT X  :: GOTO 110
 1050 ON RN ( 4 ) GOTO 1060, 1110, 1120, 1130
 1060 PRINT "DAS ERGIBT KEINEN SINN."  :: GOTO 110
 1110 PRINT "JETZT NICHT !!"  :: GOTO 110
 1120 PRINT "NICHT HIER !!"  :: GOTO 110
 1130 PRINT "NICHT MIT MIR !!"  :: GOTO 110
 1140 IF P = 7 THEN IF Z = 0 THEN PRINT "NICHT MOEGLICH!!"  :: GOTO 110ELSE Z = 0 
 1150 IF P = 15 AND M = 0 THEN PRINT "DAZU BIN ICH NOCH ZU SCHWACH"  :: GOTO 110ELSE IF P = 15 AND M = 1 THEN M , Q = 0 
 1160 IF P = 27 AND G$ = "OST" AND N = 0 THEN PRINT "DIESE RICHTUNG IST DURCH"  : "EINE TUER VERSPERRT."  :: GOTO 110
 1170 IF P = 19 AND G$ = "SUE" AND [ = 0 THEN PRINT "DU WIRST VON EINEM"  : "GROTTENOLM ANGEGRIFFEN !"  :: P = 15  :: GOTO 110
 1180 IF P = 19 AND G$ = "SUE" AND [ = 1 THEN PRINT "EIN GROTTENOLM ERSCHEINT."  : "AUS ANGST VOR DEM SCHWERT   FLIEHT ER."  :: CALL P 
 1190 IF P = 14 AND L < 2 THEN PRINT "DU BIST IM DUNKELN GEGEN    EINEN FELSEN GELAUFEN."  :: P = 15  :: GOTO 110
 1200 IF H = 0 AND P = 32 AND G$ = "OST" THEN PRINT "EIN HUND VERSPEERT DEN WEG."  :: GOTO 110
 1210 IF P < > 20 OR ( M$ ( 1 ) = "NOR" AND M$ ( 2 ) = "SUE" AND M$ ( 3 ) = "OST" AND M$ ( 4 ) = "WES" ) THEN 1220
 1212 FOR X = 1 TO 3  :: M$ ( X ) = M$ ( X + 1 )  :: NEXT X  :: M$ ( 4 ) = G$  :: GOTO 110
 1220 IF P = 34 AND @ = 1 THEN PRINT "EIN KNECHT REGT SICH UEBER  MEINEN SPEER AUF. ER NIMMT  MIR ALLES AB UND WIRFT MICH RAUS!"  :: CALL P  :: GOTO 50
 1230 IF P = 23 THEN E$ = "BAE"  :: GOSUB 1250 :: IF ] = 1 THEN PRINT "DIE BAEREN REISSEN DEN"  : "SCHLUESSEL VOM BODEN AB."  :: W = 1  :: GOTO 110
 1240 GOTO 180
 1250 ] = 0  :: FOR X = 1 TO I  :: IF POS ( L$ ( X ) , E$ , 1 ) THEN ] = 1  :: RETURN 
 1260 NEXT X  :: RETURN 
 1270 DATA AUF EINER WIESE. , AUF EINER LICHTUNG. , AUF EINEM FRIEDHOF. , IN EINER KAPELLE , IN EINEM KAEFIG. , IN EINEM ZOO. , AN EINEM SEE. 
 1275 DATA IN EINEM SUMPF. , VOR EINEM BAUM. , AUF EINEM BERG. , AM NORDENDE EINES TALS. , IN EINEM TUNNEL. , IN EINEM BERGWERK. , IN EINEM TUNNEL. 
 1280 DATA IM KRANKENHAUS. , IM MOOR. , AN EINEM FLUSS. , AM SUEDENDE EINES TALS. , IN EINEM LOCH. , IN EINEM LEEREN RAUM. , IM ERDGESCHOSS EINES TURMES. 
 1285 DATA IM KAMINRAUM. , IN EINEM KLEINEN RAUM. , IRGENDWO. , AUF EINEM PFAD. , AUF EINER EBENE. , IN EINEM STALL. , IN EINEM HEUSCHOBER. 
 1290 DATA IN EINEM KELLER. , IN EINEM FUCHSBAU. , IN EINEM WALD. , IN EINEM DORF. , IN EINEM HAUS. , AUF DEM HINTERHOF. , 0 , 7 , 0 , 0 , 0 , 7 , 0 , 0 , 0 
 1295 DATA 7 , 1 , 0 , 0 , 7 , 1 , -1 , 0 , 7 , 1 , -1 , 0 , 7 , 0 , -1 , 0 , 7 , 1 , 0 , -7 , 0 , 1 , -1 , -7 , 7 , 1 , -1 , -7 , 7 , 1 , -1 , 0 , 7 , 1 , -1 , 0 , 0 
 1297 DATA 1 , -1 , -7 , 7 , 0 , -1 , -7 , 7 , 0 , 0 , -7 , 0 , 1 , 0 , -7 , 8 , 0 , 0 , -7 , 8 , 0 , 0 , -7 , 8 , 1 , 0 , 0 , 8 , 0 , -1 , -7 , 0 , 0 , 0 , -7 , 8 
 1300 DATA 1 , 0 , 0 , 0 , 1 , -1 , 0 , 0 , 0 , -1 , -8 , 0 , 1 , 0 , -8 , 7 , 1 , -1 , -8 , 0 , 0 , -1 , -8 , 7 , 1 , 0 , 0 , 0 , 0 , -1 , -8 , 0 , 0 , 0 , -8 , 0 
 1303 DATA 1 , -1 , 0 , 0 
 1305 DATA 1 , -1 , -7 , 0 , 1 , -1 , 0 , 0 , 1 , -1 , -7 , 0 , 0 , -1 , EINEN STOCK. , EINEN RITTER. , VIELE GRAEBER. , EINEN ALTAR. , EINE SCHAUKEL. 
 1310 DATA ZWEI BAEREM. , EIN BOOT. , EINE SCHLANGE. , NICHTS. , WOLKEN. , NICHTS. , EINE LAMPE. , EINEN GRUBENWAGEN. , NICHTS. , EINEN ARZNEIKASTEN. 
 1315 DATA KROKODILE. , DIE ANDERE SEITE. , EIN LOCH. , NICHTS. , NICHTS. , EINEN ZETTEL. , FEUERHOLZ. , EINEN SCHLUESSEL. , NEBEL. , SPUREN. 
 1320 DATA NICHTS BESONDERES. , HEU. , HEU. , EIN FASS. , EINE MUENZE. , BAEUME. , HAEUSER. , EINEN TISCH. , EINEN MISTHAUFEN. , EINEN STOCK. , EINE SCHAUKEL. 
 1325 DATA ZWEI BAEREN. , EINE LAMPE. , EINE MUENZE. 
 1330 I$ , E$ = ""  :: PRINT "WAS SOLL ICH TUN ?"  :: LINPUT ""  : C$  :: PRINT  :: IF LEN ( C$ ) < 3 THEN F$ = G$  :: GOTO 210
 1335 F$ = SEG$ ( C$ , 1 , 3 )  :: K = LEN ( C$ )  :: J = 1  :: FOR X = 1 TO K  :: IF SEG$ ( C$ , X , 1 ) = " " THEN 1340
 1337 I$ = I$ & SEG$ ( C$ , X , 1 )  :: NEXT X 
 1340 IF SEG$ ( C$ , K - J , 1 ) < > " " THEN J = J + 1  :: IF J < > K THEN 1340
 1350 CALL R ( C$ , J , E$ )  :: G$ = SEG$ ( C$ , K - J + 1 , 3 )  :: RETURN 
 1500 ON ERROR 1500 :: RETURN NEXT 
 2000 SUB R ( A$ , X , B$ ) 
 2010 IF LEN ( A$ ) < = X THEN B$ = A$  :: SUBEXIT 
 2020 B$ = SEG$ ( A$ , LEN ( A$ ) - X + 1 , X )  :: SUBEND 
 3000 SUB P 
 3010 FOR X = 1 TO 1500  :: NEXT X 
 3020 SUBEND 
