   40 CALL CLEAR 
   50 REM  INIT-COLOR 
   60 CALL SCREEN ( 2 ) 
   70 FOR A = 1 TO 13 
   80 CALL COLOR ( A , 16 , 1 ) 
   90 NEXT A 
  100 CALL COLOR ( 14 , 8 , 1 ) 
  110 CALL COLOR ( 15 , 8 , 1 ) 
  120 CALL COLOR ( 16 , 10 , 1 ) 
  130 REM  INIT-GRAPHIK 
  140 DIM C$ ( 127 ) 
  150 FOR I = 0 TO 127 
  160 C$ ( I ) = "0000000000000000" 
  170 NEXT I 
  180 OR$ = "84219531A623B733C465D575E667F7778CA99DB9AEABBFBBCCEDDDFDEEEFFFFF" 
  190 CHR = 31 
  200 REM - HAUPTPROGRAMM 
  210 RANDOMIZE 
  220 CALL CLEAR 
  230 PRINT "<BITTE EINE TASTE DRUECKEN>"  :  :  : 
  240 CALL KEY ( 0 , A , B ) 
  250 IF B < 1 THEN 240
  260 CALL HCHAR ( 1 , 1 , 31 , 768 ) 
  270 FOR Z = 1 TO 2 
  280 W = 0 
  290 IF Z = 1 THEN 320
  300 W = 3.141592653586 
  310 REM  STERNENSPIRALE 
  320 FOR A = 0 TO 2 STEP .01 
  330 REM  EINZELSTERNE 
  340 R = EXP ( A ) ^ 2 
  350 COSW = COS ( W ) 
  360 XS = COSW * 2 * R + 128 
  370 YS = SIN ( W ) * R / 2 + 100 + COSW * R 
  380 X = XS 
  390 Y = YS 
  400 GOSUB 650
  410 REM  STERNE IN UMGEBUNG 
  420 IS = 1 
  430 IF A > 1.85 THEN 470
  440 IS = 2 
  450 IF A > 1.75 THEN 470
  460 IS = A * 2 + 1 
  470 FOR R = 0 TO IS 
  480 DX = RND * 6 - 3 
  490 DY = RND * 6 - 3 
  500 X = XS + DX 
  510 Y = YS + DY 
  520 GOSUB 650
  530 NEXT R 
  540 W = W + RND / 5 
  550 NEXT A 
  560 NEXT Z 
  570 REM  HINTERGRUNDSTERNE   
  580 X = INT ( RND * 253 + 2 ) 
  590 Y = INT ( RND * 189 + 2 ) 
  591 GOSUB 650
  593 X = X + 1 
  594 GOSUB 650
  596 X = X - 1 
  597 Y = Y - 1 
  598 GOSUB 650
  600 Y = Y + 2 
  601 GOSUB 650
  603 Y = Y - 1 
  604 X = X - 1 
  605 GOSUB 650
  607 IF CHR > = 159 THEN 620ELSE 580
  620 CALL KEY ( 0 , A , B ) 
  630 IF A < > 66 THEN 620
  640 END 
  650 REM --PSET 
  660 YI = INT ( Y ) 
  670 XI = INT ( X ) 
  680 YC = INT ( YI / 8 ) 
  690 XC = INT ( XI / 8 ) 
  700 CALL GCHAR ( YC + 1 , XC + 1 , IN ) 
  710 IF IN < > 31 THEN 760
  720 CHR = CHR + 1 
  725 IF CHR > 159 THEN 840
  730 CALL CHAR ( CHR , "" ) 
  740 CALL HCHAR ( YC + 1 , XC + 1 , CHR ) 
  750 IN = CHR 
  760 W$ = C$ ( IN - 32 ) 
  770 NYB = ( YI - YC * 8 ) * 2 + 1 
  780 IF XI - INT ( XI / 8 ) * 8 < 4 THEN 800
  790 NYB = NYB + 1 
  800 NYB$ = SEG$ ( W$ , NYB , 1 ) 
  810 W$ = SEG$ ( W$ , 1 , NYB - 1 ) & SEG$ ( OR$ , POS ( "0123456789ABCDEF" , NYB$ , 1 ) * 4 - 3 + XI - INT ( XI / 4 ) * 4 , 1 ) & SEG$ ( W$ , NYB + 1 , 16 ) 
  820 C$ ( IN - 32 ) = W$ 
  830 CALL CHAR ( IN , W$ ) 
  840 RETURN 
